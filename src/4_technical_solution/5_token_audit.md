# Token Audit

There are four steps to audit the NFT and confirm its authenticity.

## 1 - Stegano hash verification

First retrieve the current stegano file (stegano file from current owner) from its location (usually IPFS) and compute its hash. The resulting hash should be equal to the hash stored in the NFT smart contract storage. If not, the NFT location URL does not correspond to the file.

## 2 - Steganography operation verification

Second step is to retrieve the ownership meta-data embedded inside the file using the same steganography algorithm used for the ownership certification. The result of the operation should be a JSON document (stegano meta-data).
If the meta-data is readable, the audit can continue. If the result is unreadable (not a JSON document), that means the steganography algorithm is not the one used to embed the meta-data or there is no meta-data. Then retrieve the genesis file and use the steganography algorithm to recompute the stegano file. The computed file should have the same hash as the stegano hash in the smart contract.

The genesis file is the “true file” that has been generated by the creator. The stegano meta-data (steganography meta-data) should be in a JSON format, containing two fields: a message (also as a JSON) and its signature.

## 3 - Ownership verification

Step three, the signature is the combination of the message and the current owner's private key. The authenticity of the message needs to be verified using its signature and the so-called owner public key (“so-called” because we don’t know yet if the public key is the true token owner). If the signature is the signature of the message by the token owner’s private key, it confirms that the message was indeed generated by the token owner: “I, Alice, certifies I have written this message.”.

## 4 - Stegano meta-data verification

The fourth and last step of the audit is to confirm the authenticity of the ownership meta-data embedded in the file. We need to verify owner counter (must be correct owner index), blockchain network, TX hash (must be the transaction hash of the target token ownership transfer on the blockchain network specified by the value “blockchain network”) and parent file hash (must be stegano hash of the previous stegano file in the Ownership-Chain).

## 4 bis - Storage variable verification

If included, verify the value of the storage variable values included. Compare the state of the storage variables at the block number the TX hash specified above. The values should be equal, if not the ownership certification is fraudulent. Also, it is a good idea to verify the consistency of the storage variables included. That means to verify that every storage variable embedded in previous stegano files is present (not been dropped) and that no other variables have been included.
